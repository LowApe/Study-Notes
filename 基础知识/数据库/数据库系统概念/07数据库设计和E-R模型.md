# 数据库设计和 E-R 模型

本章讲述一个 E-R 设计如何转化成一个关系模式的集合以及如何在该设计中找到某些约束



## 设计过程概览

### 设计阶段

由于现实的应用常常很复杂，通常没有一个人能够理解应用的所有数据需求。数据可设计者必须与应用的用户进行交互以及理解应用的需求，把它们以用户能够理解的高级别的形式表示出来，然后再将**需求转化为较低级别的设计**。

- 数据库设计最初阶段需要完整刻画未来数据库用户的数据需求
- 选择数据模型。本章研究实体-联系模型用于表示**概念设计**
- 完善概念模式还指明企业的功能需求
- 从抽象数据到数据库转换过程在最后两个设计阶段
	- 逻辑设计阶段
	- 物理设计阶段

### 设计选择

数据库设计过程中我们使用**实体(entity)**这个术语来指示所有可明确识别的个体。在设计一个数据库模式的时候，我们必须确保避免两个主要的缺陷：

- 冗余：信息的这种冗余表的最大问题是当对一条信息进行更新但没有将这条信息的所有拷贝都更新时，这条信息的拷贝会变得不一致
- 不完整：



## 实体 - 联系模型

实体-联系数据模型在方便数据库的设计，它是通过允许定义代表数据库全局逻辑结构的**企业模式**实现的。E-R 数据模型采用了三个基本概念：**实体集、联系集和属性**

### 实体集

> 实体：是现实世界中可区别其他对象的一个事务或对象
> 实体集：是相同类型即具有相同性质(或属性)的一个实体集合。

相关概念：

- 实体集不必互不相交🤔
- 实体通过一组属性来表示
- 每个实体的每个属性都有一个值
- 数据库包括一组实体集，每个实体集包括在任意数量的相同类型的实体

### 联系集

> 联系：是指多个实体间的相互关联。
> 联系集：是相同类型联系的集合

实体集之间的关联称为参与；实体集参与联系集。

E-R 模式中的一个**联系实例**表示在所建模的现实世界企业中命名实体间的一个关联

参与联系集的实体集的数目称为**联系集的度**。二元联系集的度为 2；三元联系集的度为 3

> ⚠️注意：这里联系应该是设计表的关系，负责的关系设计到复杂的表结构，这里说的不是很清楚，看看之后有没有讲解这一块内容

### 属性

每个属性都有一个可取值的集合，称为该属性的域，或者值集。属性的域很可能是**集合{春，夏，秋，冬}中的字符串**。实体集的属性是将实体集**映射到域的函数**

由于一个实体集可能有多个属性，因此每个实体可以用一组(属性，数据值)对来表示，实体集的每个属性对应一个这样的对。用来描述实体的属性值构成存储在数据库中的数据的一个重要部分

E-R 模型中的属性可以按照如下的属性类型进行划分：

- 简单和复合属性。**复合属性**可以再划分为更小的部分(即其他属性)。例如，属性 name 可以设计一个包括 first_name、middle_initial 和 last_name 的复合属性。如果一个用户希望在一些场景中引用完整的属性，而在另外的场景中仅引用属性的一部分，则在设计模式中使用复合属性是一个好的选择。

![image.png](http://ww1.sinaimg.cn/large/006rAlqhly1g9ushmtdobj30h60duwf2.jpg)

- 派生属性。这类属性的值可以从别的相关属性或实体派生出来。例如，让我假设 instructor 实体集有一个属性 students_adviseds,表示一个教师指导了多少个学生，我们可以通过统计与一个教师相关联的所有 student 实体的数目来得到这个属性的值。**派生属性的值不存储，而是在需要的时候计算出来**

## 约束

这一节讨论映射基数以及参与约束

### 映射基数

> 映射基数，或基数比率，表示一个实体通过一个联系集能关联的实体的个数。映射基数在描述二元联系集时非常有有

对于实体集 A 和 B 之间的二元联系集 R 来说，映射基数必然是以下情况之一：

- 一对一。
- 一对多
- 多对一
- 多对多

### 参与约束

如果实体集 E 中的每个实体都参与到联系集 R 的至少一个联系中，实体集 E在联系集 R 中的参与称为**全部**。如果 E 中只有部分实体参与到 R 的联系中，实体集 E 到联系集 R 的参与称为**部分**。

### 码

我们必须有一个区分给定实体集中的实体的方法。从概念上来说，各个实体是互异的；但从数据库的观点来看，它们的区别必须通过其属性来表示。

一个实体的属性的值必须可以**唯一表识该实体**

🤔

