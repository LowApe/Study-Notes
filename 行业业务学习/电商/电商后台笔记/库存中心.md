# 库存中心

> 库存管理作为供应链管理的重要组成部分。最重要的是**库存的分配**与**扣减逻辑**

- 电商库存体系分为三层: 销售层、调度层、仓库层
- 库存的变动分为自上而下、自下而上两种
- 每一层库存数量的变化可总结为**增加、锁定、解锁、扣减、返还、异常处理等**

> 库存数据的变动都需要有相关单据依据，例如**销售订单、收发货单、采购入库单等**



# 库存分层



## 库存的概念

> 电商中的库存管理是为了保证前台商品的正常售卖，**库存的管理和仓库密不可分**，而仓库又和销售、采购相关，**库存变动的影响因素**

- 销售订单
- 采购
- 仓间调拨
- 盘盈盘亏
- 预售
- 售后退货等因素

## 库存三层模型：

| 分层   | 职能                                                         |
| ------ | ------------------------------------------------------------ |
| 销售层 | 可销售库存(=0 缺货)、锁定库存(下单锁库存，支付后扣减库存)、<br />已销售库存(统计已售数量)、活动库存(活动如秒杀，分配固定数量)、预售库存(虚拟库存，备货之后，再推送至调度层) |
| 调度层 | 总计及分区域：<br />账面库存、可用库存、在途库存<br />不可销售库存、已用库存 |
| 仓库层 | 可用库存、锁定库存、<br />已出库库存、不可用库存             |

> **调度层**相当于订单的分配中心，**将订单转化为发货单**，按照调度规则决定那些 SKU 由哪个仓库发货。调度层的库存分为 **单仓、区域、总库存(所有库存的SKU库存总计)**
>
> - 账面库存：仓库中的实物库存，只要未出库都算在账面库存中
> - 可用库存: 仓库中可供发货的库存。
> - 在途库存:下了采购单但是尚未入库的库存，在途库存理论上部分是可供销售的，例如"T+1"在途库存，就是指 1日之后就可以入库的 SKU
> - 不可销售库存:库存盘损的库存，通常是库存中的不良品，是无法售卖的库存。
> - 已用库存：在调度层已分配的库存



**仓库层**

1. 可用库存:发货单推知仓库后，仓库可以用于发货的库存，不包括锁定的库存
2. 锁定库存:发货单推送至仓库后锁定库存，锁定时同时去锁定库位库存
3. 不可用库存：盘点时发现的不良品，需要报损，从可用库存转换为不可用库存



## 库存同步

触发库存发生变动的点不一样，库存的变动有两种流向。一种是自上而下，一种是自下而上

- 自上而下：用户下单后，首先会生成**订单**，**扣减销售层的库存**；然后流转到调度层进行调度，生成**发货通知单**。调整调度层的库存；最后推送至仓库，WMS 系统同步响应，扣减库存并进行出库
- 自下而上：仓库的实物入库可以算是从下到上引起的库存变动。主要有三种单据:**采购入库单等、退货入库单、调拨入库单**。实物入库，会连锁引起仓库层、调度层、销售层的可用库存逐步增加

# 销售库存管理

> 一般情况下，销售层的库存要和调度层的实物库存保持一致。但是有些业务需求是允许超卖、做预售、不同互动独占库存、不同渠道分配库存，**就会造成预售层库存与调度层实物库存不一致**。场景如下：

1. 允许超卖。双 11、 618 活动时，运修超卖。只要及时补货就行
2. 做预售。先交钱，预估出货时间，等有货了再给买家发货
3. 不同活动独占库存。拼团、限时秒杀这类促销活动，往往是从实际库存取出部分库存来做活动
4. 不同渠道分配库存。许多商家有多个渠道，通常共用一套库存。多个店限时相同的商品数量，需要设置警戒值，当库存数量低于警戒值时，将所有商品下架处理，另外每当商品销售后，也需要更新其他各渠道的商品库存。

....



# 库存调度逻辑





# 库存控制策略







